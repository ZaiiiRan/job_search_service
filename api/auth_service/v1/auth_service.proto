syntax = "proto3";

package auth_service.v1;

option go_package = "github.com/ZaiiiRan/job_search_service/auth-service/gen/go/auth-service/v1;authv1";

import "google/api/annotations.proto";
import "protoc-gen-openapiv2/options/annotations.proto";
import "user_service/v1/user_service.proto";

option (grpc.gateway.protoc_gen_openapiv2.options.openapiv2_swagger) = {
    info: {
        title: "Auth Service API";
        version: "1.0";
        description: "API for registration, authorization, changing and resetting passwords, and updating user tokens";
    };
    host: "localhost:8082";
    schemes: HTTP;
    schemes: HTTPS;
    consumes: "application/json";
    produces: "application/json";
};

service AuthService {
    rpc RegisterApplicant(RegisterApplicantRequest) returns (RegisterApplicantResponse) {
        option (google.api.http) = {
            post: "/api/v1/applicant/register",
            body: "*"
        };
        option (grpc.gateway.protoc_gen_openapiv2.options.openapiv2_operation) = {
            summary: "Register applicant user"
            description: "Registers applicant"
            tags: "applicants"
        };
    }

    rpc GetNewApplicantActivationCode(GetNewApplicantActivationCodeRequest) returns (GetNewApplicantActivationCodeResponse) {
        option (google.api.http) = {
            get: "/api/v1/applicant/new-activation-code"
        };
        option (grpc.gateway.protoc_gen_openapiv2.options.openapiv2_operation) = {
            summary: "Get new applicant activation code"
            description: "Sending a new account activation code"
            tags: "applicants"
        };
    }

    rpc ActivateApplicant(ActivateApplicantRequest) returns (ActivateApplicantResponse) {
        option (google.api.http) = {
            post: "/api/v1/applicant/activate",
            body: "*"
        };
        option (grpc.gateway.protoc_gen_openapiv2.options.openapiv2_operation) = {
            summary: "Activate applicant accout"
            description: "Activates a new applicant account"
            tags: "applicants"
        };
    }

    rpc LoginApplicant(LoginApplicantRequest) returns (LoginApplicantResponse) {
        option (google.api.http) = {
            post: "/api/v1/applicant/login",
            body: "*"
        };
        option (grpc.gateway.protoc_gen_openapiv2.options.openapiv2_operation) = {
            summary: "Login applicant"
            description: "Applicant authorization"
            tags: "applicants"
        };
    }

    rpc RefreshApplicant(RefreshApplicantRequest) returns (RefreshApplicantResponse) {
        option (google.api.http) = {
            post: "/api/v1/applicant/refresh",
            body: "*"
        };
        option (grpc.gateway.protoc_gen_openapiv2.options.openapiv2_operation) = {
            summary: "Refresh applicant"
            description: "Returns a new pair of tokens"
            tags: "applicants"
        };
    }

    rpc LogoutApplicant(LogoutApplicantRequest) returns (LogoutApplicantResponse) {
        option (google.api.http) = {
            delete: "/api/v1/applicant/logout"
        };
        option (grpc.gateway.protoc_gen_openapiv2.options.openapiv2_operation) = {
            summary: "Logout applicant"
            description: "Deactivates applicant tokens"
            tags: "applicants"
        };
    }

    rpc GetResetApplicantPasswordCode(GetResetApplicantPasswordCodeRequest) returns (GetResetApplicantPasswordCodeResponse) {
        option (google.api.http) = {
            post: "/api/v1/applicant/reset-password/code",
            body: "*"
        };
        option (grpc.gateway.protoc_gen_openapiv2.options.openapiv2_operation) = {
            summary: "Get reset applicant's password code"
            description: "Sends a password recovery code"
            tags: "applicants"
        };
    }

    rpc ResetApplicantPassword(ResetApplicantPasswordRequest) returns (ResetApplicantPasswordResponse) {
        option (google.api.http) = {
            post: "/api/v1/applicant/reset-password",
            body: "*"
        };
        option (grpc.gateway.protoc_gen_openapiv2.options.openapiv2_operation) = {
            summary: "Reset applicant password"
            description: "Resets applicant password"
            tags: "applicants"
        };
    }

    rpc ChangeApplicantPassword(ChangeApplicantPasswordRequest) returns (ChangeApplicantPasswordResponse) {
        option (google.api.http) = {
            post: "/api/v1/applicant/change-password",
            body: "*"
        };
        option (grpc.gateway.protoc_gen_openapiv2.options.openapiv2_operation) = {
            summary: "Change applicant password"
            description: "Changes applicant password"
            tags: "applicants"
        };
    }

    rpc RegisterEmployer(RegisterEmployerRequest) returns (RegisterEmployerResponse) {
        option (google.api.http) = {
            post: "/api/v1/employer/register",
            body: "*"
        };
        option (grpc.gateway.protoc_gen_openapiv2.options.openapiv2_operation) = {
            summary: "Register employer user"
            description: "Registers employer"
            tags: "employers"
        };
    }

    rpc GetNewEmployerActivationCode(GetNewEmployerActivationCodeRequest) returns (GetNewEmployerActivationCodeResponse) {
        option (google.api.http) = {
            get: "/api/v1/employer/new-activation-code",
        };
        option (grpc.gateway.protoc_gen_openapiv2.options.openapiv2_operation) = {
            summary: "Get new employer activation code"
            description: "Sending a new account activation code"
            tags: "employers"
        };
    }

    rpc ActivateEmployer(ActivateEmployerRequest) returns (ActivateEmployerResponse) {
        option (google.api.http) = {
            post: "/api/v1/employer/activate",
            body: "*"
        };
        option (grpc.gateway.protoc_gen_openapiv2.options.openapiv2_operation) = {
            summary: "Activate employer"
            description: "Activates a new employer account"
            tags: "employers"
        };
    }

    rpc LoginEmployer(LoginEmployerRequest) returns (LoginEmployerResponse) {
        option (google.api.http) = {
            post: "/api/v1/employer/login",
            body: "*"
        };
        option (grpc.gateway.protoc_gen_openapiv2.options.openapiv2_operation) = {
            summary: "Login employer"
            description: "Employer authorization"
            tags: "employers"
        };
    }

    rpc RefreshEmployer(RefreshEmployerRequest) returns (RefreshEmployerResponse) {
        option (google.api.http) = {
            post: "/api/v1/employer/refresh",
            body: "*"
        };
        option (grpc.gateway.protoc_gen_openapiv2.options.openapiv2_operation) = {
            summary: "Refresh employer"
            description: "Returns a new pair of tokens"
            tags: "employers"
        };
    }

    rpc LogoutEmployer(LogoutEmployerRequest) returns (LogoutEmployerResponse) {
        option (google.api.http) = {
            delete: "/api/v1/employer/logout"
        };
        option (grpc.gateway.protoc_gen_openapiv2.options.openapiv2_operation) = {
            summary: "Logout employer"
            description: "Deactivates employer tokens"
            tags: "employers"
        };
    }

    rpc GetResetEmployerPasswordCode(GetResetEmployerPasswordCodeRequest) returns (GetResetEmployerPasswordCodeResponse) {
        option (google.api.http) = {
            post: "/api/v1/employer/reset-password/code",
            body: "*"
        };
        option (grpc.gateway.protoc_gen_openapiv2.options.openapiv2_operation) = {
            summary: "Get reset employer's password code"
            description: "Sends a password recovery code"
            tags: "employers"
        };
    }

    rpc ResetEmployerPassword(ResetEmployerPasswordRequest) returns (ResetEmployerPasswordResponse) {
        option (google.api.http) = {
            post: "/api/v1/employer/reset-password",
            body: "*"
        };
        option (grpc.gateway.protoc_gen_openapiv2.options.openapiv2_operation) = {
            summary: "Reset employer password"
            description: "Resets employer password"
            tags: "employers"
        };
    }

    rpc ChangeEmployerPassword(ChangeEmployerPasswordRequest) returns (ChangeEmployerPasswordResponse) {
        option (google.api.http) = {
            post: "/api/v1/employer/change-password",
            body: "*"
        };
        option (grpc.gateway.protoc_gen_openapiv2.options.openapiv2_operation) = {
            summary: "Change employer password"
            description: "Changes employer password"
            tags: "employers"
        };
    }
}

message RegisterApplicantRequest {
    user_service.v1.Applicant applicant = 1;
    string password = 2;
}

message RegisterApplicantResponse {
    user_service.v1.Applicant applicant = 1;
}

message GetNewApplicantActivationCodeRequest {}
message GetNewApplicantActivationCodeResponse {}

message ActivateApplicantRequest {
    string code = 1;
}

message ActivateApplicantResponse {
    user_service.v1.Applicant applicant = 1;
} 

message LoginApplicantRequest {
    string email = 1;
    string password = 2;
}

message LoginApplicantResponse {
    user_service.v1.Applicant applicant = 1;
}

message RefreshApplicantRequest {}
message RefreshApplicantResponse {}

message LogoutApplicantRequest {}
message LogoutApplicantResponse {}

message GetResetApplicantPasswordCodeRequest {
    string email = 1;
}

message GetResetApplicantPasswordCodeResponse {}

message ResetApplicantPasswordRequest {
    string email = 1;
    string code = 2;
    string new_password = 3;
}

message ResetApplicantPasswordResponse {
    user_service.v1.Applicant applicant = 1;
}

message ChangeApplicantPasswordRequest {
    string old_password = 1;
    string new_password = 2;
}

message ChangeApplicantPasswordResponse {}

message RegisterEmployerRequest {
    user_service.v1.Employer employer = 1;
    string password = 2;
}

message RegisterEmployerResponse {
    user_service.v1.Employer employer = 1;
}

message GetNewEmployerActivationCodeRequest {}
message GetNewEmployerActivationCodeResponse {}

message ActivateEmployerRequest {
    string code = 1;
}

message ActivateEmployerResponse {
    user_service.v1.Employer employer = 1;
} 

message LoginEmployerRequest {
    string email = 1;
    string password = 2;
}

message LoginEmployerResponse {
    user_service.v1.Employer employer = 1;
}

message RefreshEmployerRequest {}
message RefreshEmployerResponse {}

message LogoutEmployerRequest {}
message LogoutEmployerResponse {}


message GetResetEmployerPasswordCodeRequest {
    string email = 1;
}

message GetResetEmployerPasswordCodeResponse {}

message ResetEmployerPasswordRequest {
    string email = 1;
    string code = 2;
    string new_password = 3;
}

message ResetEmployerPasswordResponse {
    user_service.v1.Employer employer = 1;
}

message ChangeEmployerPasswordRequest {
    string old_password = 1;
    string new_password = 2;
}

message ChangeEmployerPasswordResponse {}
